name: âš¾ MLB ê²½ê¸° ì¢…ë£Œ ìë™ í¬ìŠ¤íŠ¸

on:
  schedule:
    # â­ 15ë¶„ë§ˆë‹¤ ì‹¤í–‰ â†’ ê²½ê¸° ì¢…ë£Œ í›„ ìë™ í¬ìŠ¤íŒ…
    - cron: '*/15 * * * *'

  # ìˆ˜ë™ ì‹¤í–‰ ë²„íŠ¼
  workflow_dispatch:

jobs:
  generate-mlb-post:
    runs-on: ubuntu-latest

    steps:
      # ë ˆí¬ ì²´í¬ì•„ì›ƒ
      - name: ğŸ“¥ Checkout repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      # Python ì„¤ì¹˜
      - name: ğŸ Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'

      # íŒ¨í‚¤ì§€ ì„¤ì¹˜
      - name: ğŸ“¦ Install packages
        run: |
          pip install requests anthropic pillow

      # í¬ìŠ¤íŠ¸ ìƒì„± ì‹¤í–‰
      - name: âš¾ Generate MLB Post
        env:
          ANTHROPIC_API_KEY: ${{ secrets.ANTHROPIC_API_KEY }}
        run: |
          python automation/mlb_auto_post.py

      # ìë™ ì»¤ë°‹ & í‘¸ì‹œ
      - name: ğŸ“¤ Commit & Push
        run: |
          git config --local user.email "mlb-bot@github.io"
          git config --local user.name "âš¾ MLB Bot"
          git add _posts/
          git diff --staged --quiet || git commit -m "âš¾ MLB ê²½ê¸° ê²°ê³¼ ì—…ë°ì´íŠ¸"
          git push
